import{d as S,u as A,r as c,o as _,c as p,w as e,a as t,b as n,e as T,I as b,f as m,g as h,h as C,i as g,t as I,j as E,k as L,l as B,S as $,m as N,n as P,p as F,q as V,s as W,F as z,v as K,x as R,y as j,z as q,A as H,_ as O}from"./index-ab79e5dd.js";import{g as G,p as J,a as y}from"./methods-cdf3a436.js";const M=["src"],Q={key:0,class:"contactUsername"},X={key:1},Y=S({__name:"ChatElement",props:{avatarSrc:String,contactUserID:String,contactUsername:String,contactEmail:String,lastAccessTimestamp:String},setup(o){const r=A();function f(u,s,i){try{const l=new CustomEvent("openDialogue",{detail:{user:u,user_id:s,email:i}}),a=G();r.updateTimestampOfActiveChatWithID(s,a),r.setLastActiveChatWasWithID(s),window.dispatchEvent(l)}catch(l){}finally{B.push("/tabs/dialogue")}}async function d(u){$.fire({title:"Chat mit Kontakt löschen?",showCancelButton:!0,confirmButtonText:"Löschen",denyButtonText:"Don't save",heightAuto:!1}).then(async s=>{if(s.isConfirmed)try{r.deleteFromActiveChats(u),r.resetCurrentDialoguePartner(),await J("Chat erfolgreich gelöscht")}catch(i){await y("Fehler beim Löschen des Chats")}else await y("Chat konnte nicht gelöscht werden")})}return(u,s)=>{const i=c("ion-icon"),l=c("ion-item-option"),a=c("ion-item-options"),v=c("ion-col"),U=c("ion-row"),w=c("ion-grid"),D=c("ion-item"),k=c("ion-item-sliding");return _(),p(k,null,{default:e(()=>[t(a,{side:"start"},{default:e(()=>[t(l,{color:"success"},{default:e(()=>[t(i,{slot:"icon-only",icon:n(T)},null,8,["icon"])]),_:1})]),_:1}),t(D,{onClick:s[0]||(s[0]=x=>f(o.contactUsername,o.contactUserID,o.contactEmail))},{default:e(()=>[t(w,null,{default:e(()=>[t(U,null,{default:e(()=>[t(v,{size:"auto"},{default:e(()=>[t(n(b),{id:"contactAvatar"},{default:e(()=>[m("img",{src:o.avatarSrc},null,8,M)]),_:1})]),_:1}),t(v,null,{default:e(()=>[o.contactUsername?(_(),h("div",Q,[t(n(C),null,{default:e(()=>[g(I(o.contactUsername),1)]),_:1})])):(_(),h("div",X,[t(n(C),null,{default:e(()=>[g(I(o.contactUserID),1)]),_:1})]))]),_:1})]),_:1})]),_:1})]),_:1}),t(a,{side:"end"},{default:e(()=>[t(l,null,{default:e(()=>[t(i,{slot:"icon-only",icon:n(E)},null,8,["icon"])]),_:1}),t(l,{color:"danger"},{default:e(()=>[t(i,{slot:"icon-only",icon:n(L),onClick:s[1]||(s[1]=x=>d(o.contactUserID))},null,8,["icon"])]),_:1})]),_:1})]),_:1})}}});const Z=o=>(q("data-v-b8ab7859"),o=o(),H(),o),tt={key:0},et=Z(()=>m("div",{align:"center"},[m("h1",{id:"forever-alone-head"},"🧐"),m("h3",null,"Nothing to see here ...")],-1)),nt=[et],ot=S({__name:"ChatsPage",setup(o){const r=A();return(f,d)=>{const u=c("ion-refresher-content"),s=c("ion-refresher"),i=c("ion-item"),l=c("ion-list");return _(),p(n(j),null,{default:e(()=>[t(n(N),{message:"Lade Kontakte ..."}),t(n(R),null,{default:e(()=>[t(n(P),null,{default:e(()=>[t(n(F),null,{default:e(()=>[g("Chats")]),_:1})]),_:1}),t(n(V),{fullscreen:!0},{default:e(()=>[t(s,{slot:"fixed","pull-factor":.5,"pull-min":100,"pull-max":200,onIonRefresh:d[0]||(d[0]=a=>f.handleRefresh(a))},{default:e(()=>[t(u)]),_:1}),t(l,{id:"chatsList"},{default:e(()=>[(_(!0),h(z,null,W(n(r).getActiveChats,a=>(_(),p(i,{key:a.user_id,id:"chatElement"},{default:e(()=>[t(Y,{avatarSrc:a.avatarUrl,lastAccessTimestamp:a.lastAccessTimestamp,contactUserID:a.user_id,contactUsername:a.user,contactEmail:a.email},null,8,["avatarSrc","lastAccessTimestamp","contactUserID","contactUsername","contactEmail"])]),_:2},1024))),128))]),_:1}),n(r).getActiveChats.length==0?(_(),h("div",tt,nt)):K("",!0)]),_:1})]),_:1})]),_:1})}}});const ct=O(ot,[["__scopeId","data-v-b8ab7859"]]);export{ct as default};
